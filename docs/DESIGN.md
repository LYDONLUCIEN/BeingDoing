# 系统设计概述

## 🎯 设计目标

帮助用户通过系统化的探索，找到真正想做的事。

## 📐 核心公式

**喜欢的事 × 擅长的事 × 重要的事 = 真正想做的事**

## 🏗️ 系统架构

### 三层架构

1. **表示层**: Next.js前端应用
2. **业务层**: FastAPI后端服务
3. **数据层**: 数据库 + 文件存储

### 核心模块

- **智能体框架**: LangGraph + ReAct范式
- **知识库系统**: CSV/Markdown加载和检索
- **对话系统**: 实时对话和历史管理
- **引导系统**: 主动/被动引导

## 🔄 用户流程

```
注册/登录
  ↓
完善个人信息
  ↓
开始探索
  ├── 探索价值观
  ├── 探索才能
  ├── 探索兴趣
  ├── 组合分析
  └── 精炼结果
  ↓
导出结果
```

## 🧠 智能体工作流程

```
用户输入
  ↓
推理节点 (分析需求)
  ↓
行动节点 (调用工具)
  ├── 搜索工具
  ├── 引导工具
  └── 示例工具
  ↓
观察节点 (处理结果)
  ↓
判断是否继续
  ├── 是 → 回到推理节点
  └── 否 → 返回最终响应
```

## 📊 数据流

### 探索数据流

```
用户回答
  → 保存到数据库 (answers表)
  → 更新进度 (progress表)
  → 触发智能体分析
  → 生成引导建议
  → 保存对话记录 (JSON文件)
```

### 对话数据流

```
用户消息
  → API接收
  → 智能体处理
  → LLM生成回复
  → 保存对话记录
  → 返回给前端
```

## 🔐 安全设计

- **认证**: JWT Token，30天有效期
- **密码**: bcrypt加密
- **数据隔离**: 按用户和会话隔离
- **输入验证**: Pydantic模型验证

## 📈 性能设计

### 当前架构（简化模式）

- 异步处理（FastAPI async/await）
- 内存缓存（知识库）
- SQLite/PostgreSQL数据库

### 扩展架构（生产模式）

- Redis缓存
- Celery任务队列
- 向量数据库（语义检索）
- Nginx反向代理

## 🔗 相关文档

- 详细架构: 查看 [架构设计文档](ARCHITECTURE.md)
- 数据库设计: 查看 [数据库设计文档](DATABASE_SCHEMA.md)
- UI定制指南: 查看 [UI 定制文档](UI_CUSTOMIZATION.md)（答题卡、建议标签样式）
- 设计文档: 查看 `planning/` 目录
