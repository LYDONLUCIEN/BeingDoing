# 渐进式引导设计说明

为了让对话更像人和人的交流（短句、渐进、一问一答），除了提示词外，可以从**结构**和**产品设计**上配合。

## 1. 提示词层面

- **单次回复尽量短**：在 system / guide / observation 等提示里明确「每次只回复 1–2 句，或一个短段+一个追问」。
- **追问优先**：要求模型在结尾用一句**具体追问**收尾（例如「你当时是怎么想的？」），而不是长段总结。
- **禁止长列表**：避免「第一、第二、第三」式长条列，改为「先讲一点 → 等用户回应 → 再讲下一点」。

## 2. 结构与接口

- **响应结构**（可选）：接口可返回结构化字段，便于前端分步展示：
  - `short_reply`: 一句话/短段（优先展示）
  - `next_question`: 建议的下一句追问（可高亮或单独展示）
  - `detail`: 可选长说明（折叠或「展开」后显示）
- **流式输出**：所有面向用户的文本都通过流式接口（如 `/chat/messages/stream`）返回，前端边收边渲染，形成「打字感」，避免一次性大段出现。

## 3. 产品与交互

- **一次只突出一个问题**：当前步骤只高亮「当前问题」一个，不堆砌多题。
- **回答后再推进**：用户提交回答后再给出下一问或下一段，而不是一次抛出很多内容。
- **长内容折叠**：若某条回复较长，前端可默认展示前 N 字 +「展开更多」，减少压迫感。
- **编辑与变更类型**：用户修改回答时记录变更类型（同向/反向/无关），便于后续分析思考模式，同时可触发后台重新梳理总结（如 `/chat/resummarize`）。

## 4. 当前实现

- **流式**：`POST /api/v1/chat/messages/stream` 在智能体跑完后按句/块流式推送回复，前端边收边显示。
- **Markdown**：对话区助手消息使用 Markdown 渲染（标题、列表、代码块、引用等）。
- **输入模式**：支持「回答本题」与「向咨询师提问」两种模式，后者走流式对话接口。

以上配合提示词与产品设计，可让整体体验更接近「渐进式、人与人式」的问答。
